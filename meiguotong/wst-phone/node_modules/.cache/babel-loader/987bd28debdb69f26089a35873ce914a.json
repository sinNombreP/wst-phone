{"remainingRequest":"C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\node_modules\\eslint-loader\\index.js??ref--13-0!C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\src\\config\\fetch.js","dependencies":[{"path":"C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\src\\config\\fetch.js","mtime":1551662549428},{"path":"C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _typeof from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\gongzuo\\\\wst\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport _Promise from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\gongzuo\\\\wst\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _Object$assign from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\gongzuo\\\\wst\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport _Object$keys from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\gongzuo\\\\wst\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"C:\\\\Users\\\\Administrator\\\\Desktop\\\\gongzuo\\\\wst\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nimport store from '../vuex/store';\nexport default\n/*#__PURE__*/\n_asyncToGenerator(\n/*#__PURE__*/\nregeneratorRuntime.mark(function _callee() {\n  var url,\n      data,\n      type,\n      method,\n      res,\n      _args = arguments;\n  return regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          url = _args.length > 0 && _args[0] !== undefined ? _args[0] : '';\n          data = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n          type = _args.length > 2 && _args[2] !== undefined ? _args[2] : 'GET';\n          method = _args.length > 3 && _args[3] !== undefined ? _args[3] : 'fetch';\n          _context.next = 6;\n          return Ajax(url, data, type, method);\n\n        case 6:\n          res = _context.sent;\n          console.log(res);\n          console.log(store.state.uid);\n\n          if (!res.success) {\n            _context.next = 17;\n            break;\n          }\n\n          if (res.body) {\n            _context.next = 12;\n            break;\n          }\n\n          return _context.abrupt(\"return\", res.success);\n\n        case 12:\n          if (!(_Object$keys(res.body).length == 1)) {\n            _context.next = 14;\n            break;\n          }\n\n          return _context.abrupt(\"return\", res.body[_Object$keys(res.body)[0]]);\n\n        case 14:\n          return _context.abrupt(\"return\", res.body);\n\n        case 17:\n          _Toast(res.msg);\n\n          return _context.abrupt(\"return\", false);\n\n        case 19:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}));\n\nfunction Ajax() {\n  return _Ajax.apply(this, arguments);\n}\n\nfunction _Ajax() {\n  _Ajax = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2() {\n    var url,\n        data,\n        type,\n        method,\n        sendData,\n        formData,\n        param,\n        _data,\n        reqConfig,\n        _param,\n        response,\n        responseJson,\n        _args2 = arguments;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            url = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : '';\n            data = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};\n            type = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 'GET';\n            method = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : 'fetch';\n            // 整理表单数据\n            type = type.toUpperCase();\n            formData = new FormData();\n            param = {\n              uid: store.state.uid,\n              key: store.state.key,\n              time: store.state.time,\n              type: store.state.type\n            };\n            data = _Object$assign(data, param);\n\n            if (type == 'GET') {\n              _data = [];\n\n              _Object$keys(data).forEach(function (key) {\n                _data.push(key + '=' + data[key]);\n              });\n\n              url = url + '?' + _data.join('&');\n              console.log(data);\n            } else {\n              //sendData = JSON.stringify(data)\n              _Object$keys(data).forEach(function (key) {\n                formData.append(key, data[key]);\n              });\n\n              console.log(formData);\n            } // 创建ajax提交对象\n\n\n            if (!(window.fetch && method == 'fetch')) {\n              _context2.next = 27;\n              break;\n            }\n\n            reqConfig = {\n              credentials: 'include',\n              method: type,\n              // headers: {\n              //   'Accept': 'application/json',\n              //   'Content-type': 'application/json'\n              // },\n              mode: 'cors',\n              //  cache: 'default',\n              cache: 'no-cache'\n            };\n\n            if (type == \"POST\") {\n              //  reqConfig = {...reqConfig,body: formData};\n              _param = {\n                body: formData\n              };\n              reqConfig = _Object$assign(reqConfig, _param);\n            }\n\n            _context2.prev = 12;\n            _context2.next = 15;\n            return fetch(url, reqConfig);\n\n          case 15:\n            response = _context2.sent;\n            _context2.next = 18;\n            return response.json();\n\n          case 18:\n            responseJson = _context2.sent;\n            return _context2.abrupt(\"return\", responseJson);\n\n          case 22:\n            _context2.prev = 22;\n            _context2.t0 = _context2[\"catch\"](12);\n            throw new Error(_context2.t0);\n\n          case 25:\n            _context2.next = 28;\n            break;\n\n          case 27:\n            return _context2.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              var reqObj;\n\n              if (window.XMLHttpRequest) {\n                reqObj = new XMLHttpRequest();\n              } else {\n                reqObj = new ActiveXObject('Microsoft.XMLHTTP');\n              }\n\n              reqObj.open(type, url, true);\n              reqObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n              reqObj.send(sendData);\n\n              reqObj.onreadystatechange = function () {\n                if (reqObj.readyState == 4) {\n                  if (reqObj.status == 200) {\n                    var res = reqObj.response;\n\n                    if (_typeof(res) !== 'object') {\n                      res = JSON.parse(res);\n                    }\n\n                    resolve(res);\n                  } else {\n                    reject(reqObj);\n                  }\n                }\n              };\n            }));\n\n          case 28:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[12, 22]]);\n  }));\n  return _Ajax.apply(this, arguments);\n}",{"version":3,"sources":["C:\\Users\\Administrator\\Desktop\\gongzuo\\wst\\src\\config\\fetch.js"],"names":["store","url","data","type","method","Ajax","res","console","log","state","uid","success","body","length","msg","toUpperCase","formData","FormData","param","key","time","_data","forEach","push","join","append","window","fetch","reqConfig","credentials","mode","cache","response","json","responseJson","Error","resolve","reject","reqObj","XMLHttpRequest","ActiveXObject","open","setRequestHeader","send","sendData","onreadystatechange","readyState","status","JSON","parse"],"mappings":"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","sourcesContent":["/*\r\n * @Description:  请求封装\r\n * @Author: 彭善智\r\n * @LastEditors: 彭善智\r\n * @Date: 2019-03-01 22:48:18\r\n * @LastEditTime: 2019-03-04 00:24:22\r\n */\r\nimport {Toast} from 'vant';\r\nimport store from '../vuex/store'\r\n\r\n\r\n\r\nexport default async (url = '', data = {}, type = 'GET', method = 'fetch')=>{\r\n  const res = await Ajax(url,data,type,method);\r\n  console.log(res);\r\n  console.log(store.state.uid);\r\n  if(res.success){\r\n    if(!res.body) return res.success;\r\n    if(Object.keys(res.body).length == 1)\r\n      return res.body[Object.keys(res.body)[0]];\r\n    return res.body;\r\n  }else{\r\n    Toast(res.msg);\r\n    return false;\r\n  }\r\n}\r\n\r\n async function Ajax(url = '', data = {}, type = 'GET', method = 'fetch'){\r\n\r\n  // 整理表单数据\r\n   type = type.toUpperCase()\r\n   let sendData;\r\n   let formData=new FormData();\r\n\r\n  let param = {\r\n    uid: store.state.uid,\r\n    key: store.state.key,\r\n    time: store.state.time,\r\n    type: store.state.type,\r\n  };\r\n  \r\n  data = Object.assign(data,param);\r\n\r\n  if (type == 'GET') {\r\n    let _data = []\r\n    Object.keys(data).forEach(key => {\r\n      _data.push(key + '=' + data[key])\r\n    })\r\n    url =  url + '?' + _data.join('&');\r\n    console.log(data);\r\n  } else {\r\n    //sendData = JSON.stringify(data)\r\n    Object.keys(data).forEach(key => {\r\n      formData.append(key,data[key]);\r\n    })\r\n    console.log(formData);\r\n  }\r\n\r\n\r\n  // 创建ajax提交对象\r\n\r\n  if (window.fetch && method == 'fetch') {\r\n    let reqConfig = {\r\n      credentials: 'include',\r\n      method: type,\r\n      // headers: {\r\n      //   'Accept': 'application/json',\r\n      //   'Content-type': 'application/json'\r\n      // },\r\n      mode: 'cors',\r\n    //  cache: 'default',\r\n      cache: 'no-cache',\r\n    }\r\n    if(type == \"POST\"){\r\n    //  reqConfig = {...reqConfig,body: formData};\r\n      let param = {body: formData}\r\n      reqConfig = Object.assign(reqConfig, param);\r\n    }\r\n    try {\r\n      const response = await fetch(url, reqConfig)\r\n      const responseJson = await response.json()\r\n      return responseJson\r\n    } catch(error) {\r\n      throw new Error(error)\r\n    }\r\n  } else {\r\n    return new Promise((resolve, reject) => {\r\n      let reqObj\r\n\r\n      if (window.XMLHttpRequest) {\r\n        reqObj = new XMLHttpRequest()\r\n      } else {\r\n        reqObj = new ActiveXObject('Microsoft.XMLHTTP')\r\n      }\r\n\r\n      reqObj.open(type, url, true)\r\n      reqObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\")\r\n      reqObj.send(sendData)\r\n\r\n      reqObj.onreadystatechange = () => {\r\n        if (reqObj.readyState == 4) {\r\n          if (reqObj.status == 200) {\r\n            let res = reqObj.response\r\n            if (typeof res !== 'object') {\r\n              res = JSON.parse(res)\r\n            }\r\n            resolve(res)\r\n          } else {\r\n            reject(reqObj)\r\n          }\r\n        }\r\n      }\r\n    })\r\n  } \r\n}\r\n"]}]}