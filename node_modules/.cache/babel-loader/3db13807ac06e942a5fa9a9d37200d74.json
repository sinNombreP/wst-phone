{"remainingRequest":"D:\\WEB\\personalWorkspace\\wst-phone\\node_modules\\babel-loader\\lib\\index.js!D:\\WEB\\personalWorkspace\\wst-phone\\node_modules\\eslint-loader\\index.js??ref--13-0!D:\\WEB\\personalWorkspace\\wst-phone\\src\\config\\fetch.js","dependencies":[{"path":"D:\\WEB\\personalWorkspace\\wst-phone\\src\\config\\fetch.js","mtime":1551503413590},{"path":"D:\\WEB\\personalWorkspace\\wst-phone\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\WEB\\personalWorkspace\\wst-phone\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"D:\\WEB\\personalWorkspace\\wst-phone\\node_modules\\eslint-loader\\index.js","mtime":499162500000}],"contextDependencies":[],"result":["import _typeof from \"D:\\\\WEB\\\\personalWorkspace\\\\wst-phone\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/typeof\";\nimport _Promise from \"D:\\\\WEB\\\\personalWorkspace\\\\wst-phone\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/promise\";\nimport \"core-js/modules/web.dom.iterable\";\nimport _Object$assign from \"D:\\\\WEB\\\\personalWorkspace\\\\wst-phone\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/assign\";\nimport \"vant/es/toast/style\";\nimport _Toast from \"vant/es/toast\";\nimport _Object$keys from \"D:\\\\WEB\\\\personalWorkspace\\\\wst-phone\\\\node_modules\\\\@babel\\\\runtime-corejs2/core-js/object/keys\";\nimport \"regenerator-runtime/runtime\";\nimport _asyncToGenerator from \"D:\\\\WEB\\\\personalWorkspace\\\\wst-phone\\\\node_modules\\\\@babel\\\\runtime-corejs2/helpers/esm/asyncToGenerator\";\nexport default\n/*#__PURE__*/\n_asyncToGenerator(\n/*#__PURE__*/\nregeneratorRuntime.mark(function _callee() {\n  var url,\n      data,\n      type,\n      method,\n      res,\n      _args = arguments;\n  return regeneratorRuntime.wrap(function _callee$(_context) {\n    while (1) {\n      switch (_context.prev = _context.next) {\n        case 0:\n          url = _args.length > 0 && _args[0] !== undefined ? _args[0] : '';\n          data = _args.length > 1 && _args[1] !== undefined ? _args[1] : {};\n          type = _args.length > 2 && _args[2] !== undefined ? _args[2] : 'GET';\n          method = _args.length > 3 && _args[3] !== undefined ? _args[3] : 'fetch';\n          console.log(data);\n          _context.next = 7;\n          return Ajax(url, data, type, method);\n\n        case 7:\n          res = _context.sent;\n          console.log(res);\n\n          if (!res.success) {\n            _context.next = 17;\n            break;\n          }\n\n          if (res.body) {\n            _context.next = 12;\n            break;\n          }\n\n          return _context.abrupt(\"return\", res.success);\n\n        case 12:\n          if (!(_Object$keys(res.body).length == 1)) {\n            _context.next = 14;\n            break;\n          }\n\n          return _context.abrupt(\"return\", res.body[_Object$keys(res.body)[0]]);\n\n        case 14:\n          return _context.abrupt(\"return\", res.body);\n\n        case 17:\n          _Toast(res.msg);\n\n          return _context.abrupt(\"return\", false);\n\n        case 19:\n        case \"end\":\n          return _context.stop();\n      }\n    }\n  }, _callee);\n}));\n\nfunction Ajax() {\n  return _Ajax.apply(this, arguments);\n}\n\nfunction _Ajax() {\n  _Ajax = _asyncToGenerator(\n  /*#__PURE__*/\n  regeneratorRuntime.mark(function _callee2() {\n    var url,\n        data,\n        type,\n        method,\n        sendData,\n        formData,\n        param,\n        _data,\n        reqConfig,\n        _param,\n        response,\n        responseJson,\n        _args2 = arguments;\n\n    return regeneratorRuntime.wrap(function _callee2$(_context2) {\n      while (1) {\n        switch (_context2.prev = _context2.next) {\n          case 0:\n            url = _args2.length > 0 && _args2[0] !== undefined ? _args2[0] : '';\n            data = _args2.length > 1 && _args2[1] !== undefined ? _args2[1] : {};\n            type = _args2.length > 2 && _args2[2] !== undefined ? _args2[2] : 'GET';\n            method = _args2.length > 3 && _args2[3] !== undefined ? _args2[3] : 'fetch';\n            console.log(data); // 整理表单数据\n\n            type = type.toUpperCase();\n            console.log(url);\n            formData = new FormData();\n            param = {\n              uid: localStorage.getItem('login_uid'),\n              key: localStorage.getItem('login_key'),\n              time: localStorage.getItem('login_time'),\n              type: localStorage.getItem('login_uid') == undefined ? 1 : 2\n            };\n            data = _Object$assign(data, param);\n            console.log(data);\n\n            if (type == 'GET') {\n              _data = [];\n\n              _Object$keys(data).forEach(function (key) {\n                _data.push(key + '=' + data[key]);\n              });\n\n              url = url + '?' + _data.join('&');\n            } else {\n              //sendData = JSON.stringify(data)\n              _Object$keys(data).forEach(function (key) {\n                formData.append(key, data[key]);\n              });\n            }\n\n            console.log(data); // 创建ajax提交对象\n\n            if (!(window.fetch && method == 'fetch')) {\n              _context2.next = 33;\n              break;\n            }\n\n            reqConfig = {\n              credentials: 'include',\n              method: type,\n              // headers: {\n              //   'Accept': 'application/json',\n              //   'Content-type': 'application/json'\n              // },\n              mode: 'cors',\n              //  cache: 'default',\n              cache: 'no-cache'\n            };\n\n            if (type == \"POST\") {\n              //  reqConfig = {...reqConfig,body: formData};\n              _param = {\n                body: formData\n              };\n              reqConfig = _Object$assign(reqConfig, _param);\n            }\n\n            _context2.prev = 16;\n            _context2.next = 19;\n            return fetch(url, reqConfig);\n\n          case 19:\n            response = _context2.sent;\n            console.log(response);\n            _context2.next = 23;\n            return response.json();\n\n          case 23:\n            responseJson = _context2.sent;\n            console.log(responseJson);\n            return _context2.abrupt(\"return\", responseJson);\n\n          case 28:\n            _context2.prev = 28;\n            _context2.t0 = _context2[\"catch\"](16);\n            throw new Error(_context2.t0);\n\n          case 31:\n            _context2.next = 34;\n            break;\n\n          case 33:\n            return _context2.abrupt(\"return\", new _Promise(function (resolve, reject) {\n              var reqObj;\n\n              if (window.XMLHttpRequest) {\n                reqObj = new XMLHttpRequest();\n              } else {\n                reqObj = new ActiveXObject('Microsoft.XMLHTTP');\n              }\n\n              reqObj.open(type, url, true);\n              reqObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\");\n              reqObj.send(sendData);\n\n              reqObj.onreadystatechange = function () {\n                if (reqObj.readyState == 4) {\n                  if (reqObj.status == 200) {\n                    var res = reqObj.response;\n\n                    if (_typeof(res) !== 'object') {\n                      res = JSON.parse(res);\n                    }\n\n                    resolve(res);\n                  } else {\n                    reject(reqObj);\n                  }\n                }\n              };\n            }));\n\n          case 34:\n          case \"end\":\n            return _context2.stop();\n        }\n      }\n    }, _callee2, null, [[16, 28]]);\n  }));\n  return _Ajax.apply(this, arguments);\n}",{"version":3,"sources":["D:\\WEB\\personalWorkspace\\wst-phone\\src\\config\\fetch.js"],"names":["url","data","type","method","console","log","Ajax","res","success","body","length","msg","toUpperCase","formData","FormData","param","uid","localStorage","getItem","key","time","undefined","_data","forEach","push","join","append","window","fetch","reqConfig","credentials","mode","cache","response","json","responseJson","Error","resolve","reject","reqObj","XMLHttpRequest","ActiveXObject","open","setRequestHeader","send","sendData","onreadystatechange","readyState","status","JSON","parse"],"mappings":"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","sourcesContent":["\r\nimport {Toast} from 'vant';\r\n\r\nexport default async (url = '', data = {}, type = 'GET', method = 'fetch')=>{\r\n  console.log(data);\r\n  const res = await Ajax(url,data,type,method);\r\n  console.log(res);\r\n  if(res.success){\r\n    if(!res.body) return res.success;\r\n    if(Object.keys(res.body).length == 1)\r\n      return res.body[Object.keys(res.body)[0]];\r\n    return res.body;\r\n  }else{\r\n    Toast(res.msg);\r\n    return false;\r\n  }\r\n}\r\n\r\n async function Ajax(url = '', data = {}, type = 'GET', method = 'fetch'){\r\n  console.log(data);\r\n  // 整理表单数据\r\n   type = type.toUpperCase()\r\n   console.log(url);\r\n   let sendData;\r\n   let formData=new FormData();\r\n\r\n  let param = {\r\n    uid: localStorage.getItem('login_uid'),\r\n    key: localStorage.getItem('login_key'),\r\n    time: localStorage.getItem('login_time'),\r\n    type: localStorage.getItem('login_uid') == undefined ? 1 : 2 ,\r\n  };\r\n  \r\n  data = Object.assign(data,param);\r\n  console.log(data);\r\n  if (type == 'GET') {\r\n    let _data = []\r\n    Object.keys(data).forEach(key => {\r\n      _data.push(key + '=' + data[key])\r\n    })\r\n    url =  url + '?' + _data.join('&')\r\n  } else {\r\n    //sendData = JSON.stringify(data)\r\n    Object.keys(data).forEach(key => {\r\n      formData.append(key,data[key]);\r\n    })\r\n  }\r\n\r\n\r\n  console.log(data);\r\n\r\n  // 创建ajax提交对象\r\n\r\n  if (window.fetch && method == 'fetch') {\r\n    let reqConfig = {\r\n      credentials: 'include',\r\n      method: type,\r\n      // headers: {\r\n      //   'Accept': 'application/json',\r\n      //   'Content-type': 'application/json'\r\n      // },\r\n      mode: 'cors',\r\n    //  cache: 'default',\r\n      cache: 'no-cache',\r\n    }\r\n    if(type == \"POST\"){\r\n    //  reqConfig = {...reqConfig,body: formData};\r\n      let param = {body: formData}\r\n      reqConfig = Object.assign(reqConfig, param);\r\n    }\r\n    try {\r\n      const response = await fetch(url, reqConfig)\r\n      console.log(response)\r\n      const responseJson = await response.json()\r\n      console.log(responseJson)\r\n      return responseJson\r\n    } catch(error) {\r\n      throw new Error(error)\r\n    }\r\n  } else {\r\n    return new Promise((resolve, reject) => {\r\n      let reqObj\r\n\r\n      if (window.XMLHttpRequest) {\r\n        reqObj = new XMLHttpRequest()\r\n      } else {\r\n        reqObj = new ActiveXObject('Microsoft.XMLHTTP')\r\n      }\r\n\r\n      reqObj.open(type, url, true)\r\n      reqObj.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded\")\r\n      reqObj.send(sendData)\r\n\r\n      reqObj.onreadystatechange = () => {\r\n        if (reqObj.readyState == 4) {\r\n          if (reqObj.status == 200) {\r\n            let res = reqObj.response\r\n            if (typeof res !== 'object') {\r\n              res = JSON.parse(res)\r\n            }\r\n            resolve(res)\r\n          } else {\r\n            reject(reqObj)\r\n          }\r\n        }\r\n      }\r\n    })\r\n  } \r\n}\r\n"]}]}